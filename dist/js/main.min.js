import clicksEvents from"./clicks.js";import sliders from"./sliders.js";import Popup from"./popup.js";import notifications from"./notifications.js";const body=document.querySelector("body"),html=document.querySelector("html"),header=document.querySelector(".header"),imageAspectRatio=document.querySelectorAll(".image-aspect-ratio, figure");imageAspectRatio.forEach(e=>{const t=e.querySelector("img"),r=getComputedStyle(e);t&&t.getAttribute("width")&&t.getAttribute("height")&&"relative"==r.position&&e.style.setProperty("--padding-aspect-ratio",Number(t.getAttribute("height"))/Number(t.getAttribute("width"))*100+"%")});const popup=new Popup({saveID:!0});popup.init();const getDeviceType=()=>{const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"mobile":"desktop"};clicksEvents(body);let windowSize=0;function resize(){header&&html.style.setProperty("--height-header",header.offsetHeight+"px"),html.style.setProperty("--vh",.01*window.innerHeight+"px"),windowSize!=window.innerWidth&&html.style.setProperty("--svh",.01*window.innerHeight+"px"),windowSize=window.innerWidth}function updatePrice(){document.querySelectorAll(".product__length_value").forEach(e=>{const t=e.parentElement,r=e,i=r.value;let o;if(r.value=Math.min(r.max,i),t.closest("[data-price-container]")&&(o=t.closest("[data-price-container]").querySelectorAll("[data-price-result]")),o){o.forEach(e=>e.textContent=(Number(r.value)*Number(r.dataset.priceValue)).toLocaleString("RU-ru"));const e=t.closest("[data-price-sum-container-id]");if(e){const t=document.querySelectorAll(`[data-price-sum-result="${e.dataset.priceSumContainerId}"]`);if(t.length){const r=e.querySelectorAll("[data-price-value]");let i=0;r.forEach(e=>{i+=Number(e.value)*Number(e.dataset.priceValue)}),t.forEach(e=>e.textContent=e.dataset.priceDiscount?(i-Number(e.dataset.priceDiscount)).toLocaleString("RU-ru"):i.toLocaleString("RU-ru"))}}}})}function validatePhoneNumber(e){return/^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){10,14}(\s*)?$/.test(e.value)}function validateEmail(e){return!!/^[^\s@]+@[^\s@]+[^\s@]+$/.test(e.value)}resize(),window.addEventListener("resize",resize),sliders(),new Sticky(".sticky"),updatePrice(),document.querySelectorAll(".product__length_value").forEach(e=>{const t=Number(e.max);Number(e.min);e.addEventListener("input",(function(r){Number(e.value)>t&&(e.value=t),updatePrice()}))}),document.querySelectorAll("form").forEach(e=>{e.querySelectorAll("input").forEach(e=>{e.addEventListener("blur",(function(t){""!=e.value?("tel"==e.type&&(validatePhoneNumber(e)?e.parentElement.classList.remove("is-error"):e.parentElement.classList.add("is-error")),"email"==e.type&&(validateEmail(e)?e.parentElement.classList.remove("is-error"):e.parentElement.classList.add("is-error"))):e.parentElement.classList.remove("is-error")}))}),e.addEventListener("submit",(function(t){!e.querySelector(".is-error")||t.preventDefault()}))}),notifications();